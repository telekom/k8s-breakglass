/*
SPDX-FileCopyrightText: 2025-2026 Deutsche Telekom AG

SPDX-License-Identifier: Apache-2.0
*/

// Code generated by controller-gen. DO NOT EDIT.

package v1alpha1

// RiskThresholdApplyConfiguration represents a declarative configuration of the RiskThreshold type for use
// with apply.
//
// RiskThreshold defines an action to take when risk score falls within a range.
type RiskThresholdApplyConfiguration struct {
	// maxScore is the upper bound (inclusive) for this threshold.
	// Thresholds are evaluated in order; use ascending maxScore values.
	MaxScore *int `json:"maxScore,omitempty"`
	// action to take when score <= maxScore: "allow", "warn", or "deny"
	// - allow: permit the request silently
	// - warn: permit but log a warning and emit metrics
	// - deny: block the request with reason message
	Action *string `json:"action,omitempty"`
	// reason is the message returned to user when action is "deny".
	// Supports Go template variables: {{.Score}}, {{.Factors}}, {{.Pod}}, {{.Namespace}}
	Reason *string `json:"reason,omitempty"`
}

// RiskThresholdApplyConfiguration constructs a declarative configuration of the RiskThreshold type for use with
// apply.
func RiskThreshold() *RiskThresholdApplyConfiguration {
	return &RiskThresholdApplyConfiguration{}
}

// WithMaxScore sets the MaxScore field in the declarative configuration to the given value
// and returns the receiver, so that objects can be built by chaining "With" function invocations.
// If called multiple times, the MaxScore field is set to the value of the last call.
func (b *RiskThresholdApplyConfiguration) WithMaxScore(value int) *RiskThresholdApplyConfiguration {
	b.MaxScore = &value
	return b
}

// WithAction sets the Action field in the declarative configuration to the given value
// and returns the receiver, so that objects can be built by chaining "With" function invocations.
// If called multiple times, the Action field is set to the value of the last call.
func (b *RiskThresholdApplyConfiguration) WithAction(value string) *RiskThresholdApplyConfiguration {
	b.Action = &value
	return b
}

// WithReason sets the Reason field in the declarative configuration to the given value
// and returns the receiver, so that objects can be built by chaining "With" function invocations.
// If called multiple times, the Reason field is set to the value of the last call.
func (b *RiskThresholdApplyConfiguration) WithReason(value string) *RiskThresholdApplyConfiguration {
	b.Reason = &value
	return b
}
