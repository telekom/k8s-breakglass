# Test DenyPolicy: Block Secrets in Production
# Denies access to secrets in production namespaces
apiVersion: breakglass.t-caas.telekom.com/v1alpha1
kind: DenyPolicy
metadata:
  name: test-block-secrets
  labels:
    e2e-test: "true"
spec:
  appliesTo:
    clusters:
      - "*"
  rules:
    - apiGroups: [""]
      resources: ["secrets"]
      verbs: ["get", "list", "watch", "create", "update", "patch", "delete"]
      namespaces:
        patterns: ["production", "prod-*"]
