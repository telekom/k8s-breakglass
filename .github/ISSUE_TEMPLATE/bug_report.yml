name: 'Bug report'
description: |
  Submit a bug report about Kubernetes Breakglass. Include a reproducible example and 
  detailed environment information. For security vulnerabilities, use the security advisory form instead.
title: '[BUG] <brief description>'
labels: ['bug', 'triage-needed']

body:
  - type: markdown
    attributes:
      value: |
        Thank you for reporting a bug! Before submitting, please:
        - Check the [documentation](https://github.com/telekom/k8s-breakglass/tree/main/docs)
        - Search [existing issues](https://github.com/telekom/k8s-breakglass/issues) for similar reports
        - For security issues, email security@telekom.de instead of using this form
  
  - type: dropdown
    id: component
    attributes:
      label: Component
      description: Which component is affected?
      options:
        - Backend (Go/API)
        - Frontend (Vue/TypeScript)
        - Kubernetes Integration (CRDs/Webhooks)
        - Authentication/OIDC
        - Deployment/Helm
        - Documentation
        - Other
    validations:
      required: true

  - type: textarea
    attributes:
      label: Describe the bug
      description: Clear and concise description of what is broken
      placeholder: |
        What happened and what did you expect to happen?
    validations:
      required: true

  - type: textarea
    attributes:
      label: Steps to reproduce
      description: Exact steps to reproduce the issue
      placeholder: |
        1. Configure ...
        2. Create a session ...
        3. Approve the request ...
        4. Bug occurs when ...
    validations:
      required: true

  - type: textarea
    attributes:
      label: Expected behavior
      description: What should happen instead?
      placeholder: |
        The session should be approved successfully and...
    validations:
      required: true

  - type: textarea
    attributes:
      label: Error logs or output
      description: |
        Relevant error messages, stack traces, or logs
      placeholder: |
        ```
        error logs here
        ```
      render: shell

  - type: textarea
    attributes:
      label: Screenshots
      description: If applicable, add screenshots (not code - use logs instead)
      placeholder: |
        You can drag and drop images here

  - type: textarea
    attributes:
      label: Environment
      description: |
        Your setup details
      value: |
        - **Breakglass Version**: [e.g., 0.0.6]
        - **Go Version**: [e.g., 1.24]
        - **Kubernetes Version**: [e.g., v1.31]
        - **OS/Platform**: [e.g., Ubuntu 22.04, macOS 14]
        - **Deployment Method**: [Helm, Kustomize, Manual]
      render: markdown
    validations:
      required: true

  - type: dropdown
    id: k8s-breakglass-version
    attributes:
      label: Breakglass Version
      description: What version are you running?
      options: 
        - 0.0.1
        - 0.0.2
        - 0.0.3
        - 0.0.4
        - 0.0.5
        - 0.0.6
        - main (development)
    validations:
      required: true

  - type: dropdown
    id: authentication
    attributes:
      label: Authentication Provider
      description: Which OIDC provider are you using?
      options:
        - Keycloak
        - Other OIDC provider
        - Not applicable / not tested yet
      required: false

  - type: textarea
    attributes:
      label: Additional context
      description: Any other relevant information
      placeholder: |
        - Related issues/PRs
        - Workarounds you've found
        - Impact on your deployment
        - Configuration snippets (sanitize secrets!)

  - type: checkboxes
    attributes:
      label: Checklist
      options:
        - label: I've checked existing issues and documentation
          required: true
        - label: I'm reporting a bug, not a security vulnerability
          required: true
        - label: I've included all relevant environment information
          required: true
        - label: I've included steps to reproduce the issue
          required: true